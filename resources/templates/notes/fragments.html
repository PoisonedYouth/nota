<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
    <!-- Einzelne Notiz-Karte -->
    <div th:fragment="note-card(note)"
         class="note-card"
         th:id="|note-${note?.id}|">
        <h3 class="note-title">
            <a th:href="@{/notes/{id}(id=${note?.id})}"
               th:text="${note?.title}"
               class="note-title-link"></a>
        </h3>
        <p class="note-content" th:text="${note?.getContentPreview()}"></p>
        <div class="note-meta">
            <span class="note-date" th:text="${note?.getFormattedDate()}"></span>
            <span th:if="${note?.dueDate != null}" class="note-due-date" th:text="|FÃ¤llig: ${note?.getFormattedDueDate()}|"></span>
            <div th:if="${!note?.archived}" class="note-actions">
                <button class="btn btn-primary btn-sm"
                        th:attr="hx-get=@{/notes/modal/{id}/edit(id=${note?.id})}"
                        hx-target="#modal-container">
                    Bearbeiten
                </button>
                <button class="btn btn-danger btn-sm"
                        th:attr="hx-delete=@{/notes/{id}(id=${note?.id})}"
                        hx-confirm="Notiz archivieren?"
                        hx-target="closest .note-card"
                        hx-swap="outerHTML swap:0.5s">
                    Archivieren
                </button>
            </div>
        </div>
    </div>

    <!-- Archive response fragment that removes note card and updates count -->
    <div th:fragment="archive-response">
        <!-- Empty content to remove the note card -->

        <!-- Out-of-band swap to update notes count -->
        <div class="notes-count"
             th:text="|${#lists.size(notes)} Notizen|"
             hx-swap-oob="true"></div>
    </div>
</body>
</html>
